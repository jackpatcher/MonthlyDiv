<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dividend Calculator</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
<div class="container my-5">
    <h2 class="text-center">Dividend Calculator</h2>
    
    <!-- Investment and Exchange Rate Section -->
    <div class="row">
        <div class="col-md-6">
            <div class="form-group">
                <label for="investment">Total Investment (THB)</label>
                <input type="number" id="investment" class="form-control" value="1000000">
            </div>
        </div>
        <div class="col-md-6">
            <div class="form-group">
                <label for="exchangeRate">Exchange Rate (THB/USD)</label>
                <input type="number" id="exchangeRate" class="form-control" value="33.97" step="0.01">
            </div>
        </div>
    </div>

    <!-- Stock Sections -->
    <div class="row">
        <!-- SCB Section -->
        <div class="col-md-4">
            <h4>SCB</h4>
            <div class="form-group">
                <label>Current Price (THB)</label>
                <input type="number" id="scbPrice" class="form-control" value="112.5">
            </div>
            <div class="form-group">
                <label>Shares Required</label>
                <input type="number" id="scbShares" class="form-control" placeholder="Calculated based on investment">
            </div>
            <div class="form-group">
                <label>Monthly Dividend per Share (THB)</label>
                <input type="number" id="scbDividend" class="form-control" value="0.667">
            </div>
            <div class="form-group">
                <label>Tax (%)</label>
                <input type="number" id="scbTax" class="form-control" value="10">
            </div>
            <h5>Monthly Dividend: <span id="scbMonthly">0</span> THB</h5>
        </div>

        <!-- O Section -->
        <div class="col-md-4">
            <h4>O</h4>
            <div class="form-group">
                <label>Current Price (USD)</label>
                <input type="number" id="oPrice" class="form-control" value="58.88">
            </div>
            <div class="form-group">
                <label>Shares Required</label>
                <input type="number" id="oShares" class="form-control" placeholder="Calculated based on investment">
            </div>
            <div class="form-group">
                <label>Monthly Dividend per Share (USD)</label>
                <input type="number" id="oDividend" class="form-control" value="0.264">
            </div>
            <div class="form-group">
                <label>Tax (%)</label>
                <input type="number" id="oTax" class="form-control" value="15">
            </div>
            <h5>Monthly Dividend: <span id="oMonthly">0</span> THB</h5>
        </div>

        <!-- JEPQ Section -->
        <div class="col-md-4">
            <h4>JEPQ</h4>
            <div class="form-group">
                <label>Current Price (USD)</label>
                <input type="number" id="jepqPrice" class="form-control" value="54.44">
            </div>
            <div class="form-group">
                <label>Shares Required</label>
                <input type="number" id="jepqShares" class="form-control" placeholder="Calculated based on investment">
            </div>
            <div class="form-group">
                <label>Monthly Dividend per Share (USD)</label>
                <input type="number" id="jepqDividend" class="form-control" value="0.380">
            </div>
            <div class="form-group">
                <label>Tax (%)</label>
                <input type="number" id="jepqTax" class="form-control" value="15">
            </div>
            <h5>Monthly Dividend: <span id="jepqMonthly">0</span> THB</h5>
        </div>
    </div>

    <!-- Dividend Summary Chart -->
    <div class="my-5">
        <canvas id="dividendChart"></canvas>
    </div>
</div>

<script  > 

    $(document).ready(function() {
    function calculateDividends() {
        const investment = parseFloat($("#investment").val());
        const exchangeRate = parseFloat($("#exchangeRate").val());

        // SCB Calculations
        const scbPrice = parseFloat($("#scbPrice").val());
        const scbDividend = parseFloat($("#scbDividend").val());
        const scbTax = parseFloat($("#scbTax").val()) / 100;
        let scbShares = parseFloat($("#scbShares").val());

        if (!scbShares) {
            scbShares = investment / scbPrice;
            $("#scbShares").val(scbShares.toFixed(2));
        }
        
        const scbMonthly = scbShares * scbDividend * (1 - scbTax);
        $("#scbMonthly").text(scbMonthly.toFixed(2));

        // O Calculations
        const oPrice = parseFloat($("#oPrice").val());
        const oDividend = parseFloat($("#oDividend").val());
        const oTax = parseFloat($("#oTax").val()) / 100;
        let oShares = parseFloat($("#oShares").val());

        if (!oShares) {
            oShares = (investment / exchangeRate) / oPrice;
            $("#oShares").val(oShares.toFixed(2));
        }

        const oMonthly = oShares * oDividend * (1 - oTax) * exchangeRate;
        $("#oMonthly").text(oMonthly.toFixed(2));

        // JEPQ Calculations
        const jepqPrice = parseFloat($("#jepqPrice").val());
        const jepqDividend = parseFloat($("#jepqDividend").val());
        const jepqTax = parseFloat($("#jepqTax").val()) / 100;
        let jepqShares = parseFloat($("#jepqShares").val());

        if (!jepqShares) {
            jepqShares = (investment / exchangeRate) / jepqPrice;
            $("#jepqShares").val(jepqShares.toFixed(2));
        }

        const jepqMonthly = jepqShares * jepqDividend * (1 - jepqTax) * exchangeRate;
        $("#jepqMonthly").text(jepqMonthly.toFixed(2));

        updateChart([scbMonthly, oMonthly, jepqMonthly]);
    }

    function updateChart(data) {
        const ctx = document.getElementById('dividendChart').getContext('2d');
        if (window.myChart) {
            window.myChart.data.datasets[0].data = data;
            window.myChart.update();
        } else {
            window.myChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['SCB', 'O', 'JEPQ'],
                    datasets: [{
                        label: 'Monthly Dividend (THB)',
                        data: data,
                        backgroundColor: ['#4e73df', '#1cc88a', '#36b9cc']
                    }]
                },
                options: {
                    scales: {
                        yAxes: [{
                            ticks: {
                                beginAtZero: true
                            }
                        }]
                    }
                }
            });
        }
    }

    // Automatically calculate on input change
    $("input").on("input", calculateDividends);

    // Initial calculation
    calculateDividends();
});


</script>
</body>
</html>
